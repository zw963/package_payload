#!/bin/bash

ROOT=$(cd "$(dirname "$BASH_SOURCE")"/.. >/dev/null; pwd)

if [[ "$1" =~ [-_.[:alnum:]]+@.+ ]]; then
    # target=${BASH_REMATCH[0]}
    scp -r $ROOT/* $ROOT/.dte "$1":/usr/local/
    ssh "$1"
elif [[ "$1" =~ ^: ]]; then
     # docker cp $ROOT/* $ROOT/.dte
     last_container=$(docker ps -q |head -n1)
     for i in $ROOT/* $ROOT/.dte; do
         docker cp "$i" ${last_container}"$1"
     done
else
    sudo scp -r $ROOT/* /usr/local/
fi
